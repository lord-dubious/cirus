import{j as e,r as S,l as E,n as H,p as v,q as N,N as C,aQ as L,s as k,d as r,V as f,v as $,w as G,k as u,E as O,X as K,Y as Q,ab as I,B as h,ay as g,T as n,aR as y,aS as X,aT as Z,aU as J,h as x,aV as T,aW as ee,Z as te,a6 as ae,ah as oe,x as ne,aF as re,aG as p}from"./index.html.c436c693.js";import{S as ie}from"./chunk-B22GDMVL.8fd7cb72.js";import"./storage.e1425d82.js";function se({size:t=16,color:a="#061548",className:o=""}){return e("svg",{className:o,width:t,height:t,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M2.66665 10.8282C1.86266 10.29 1.33331 9.37347 1.33331 8.33333C1.33331 6.77095 2.52765 5.48753 4.05314 5.34625C4.36519 3.44809 6.01348 2 7.99998 2C9.98648 2 11.6348 3.44809 11.9468 5.34625C13.4723 5.48753 14.6666 6.77095 14.6666 8.33333C14.6666 9.37347 14.1373 10.29 13.3333 10.8282M5.33331 11.3333L7.99998 14M7.99998 14L10.6666 11.3333M7.99998 14V8",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",stroke:a})})}function le({size:t=16,color:a="#061548",className:o=""}){return e("svg",{className:o,width:t,height:t,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M6 2H10M2 4H14M12.6667 4L12.1991 11.0129C12.129 12.065 12.0939 12.5911 11.8667 12.99C11.6666 13.3412 11.3648 13.6235 11.0011 13.7998C10.588 14 10.0607 14 9.00623 14H6.99377C5.93927 14 5.41202 14 4.99889 13.7998C4.63517 13.6235 4.33339 13.3412 4.13332 12.99C3.90607 12.5911 3.871 12.065 3.80086 11.0129L3.33333 4",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",stroke:a})})}const ce="_formFill_5zhls_1",P={formFill:ce};function de({goToConfirmTerms:t,setPassword:a}){const[o,i]=S.exports.useState(!1),{authenticate:s,session:c}=E(),d=H(),{clearErrors:m,formState:{errors:l},getFieldState:b,handleSubmit:M,register:V,resetField:A,watch:W}=v({mode:"all"}),{onReset:_,...q}=N({clearErrors:m,errors:l,resetField:A}),U=W("password",""),Y=async({password:F})=>{var z,D;try{i(!0),await s((D=(z=c==null?void 0:c.getIdToken())==null?void 0:z.payload)==null?void 0:D.email,F),t(),a(F)}catch{d({position:"top",render:({onClose:j})=>e(O,{message:"Incorrect email or password",onClose:j})})}finally{i(!1)}};return e(C,{maxWidth:"325px",height:"min-content",leftIcon:L,backUrl:"/app/settings",rightIcon:null,title:"Confirm your credentials",textAlign:"center",justifyContent:"center",margin:"0 auto",children:e(k,{height:"min-content",children:e("form",{className:P.formFill,children:r(f,{height:"300px",children:[e($,{fieldState:b("password"),id:"password",label:"Password",leftIcon:e(G,{}),onReset:_,registration:V("password",{required:"Password is required",...q}),type:"password"}),e(f,{mt:"auto",children:e(u,{type:"submit",variant:"glass",size:"lg",onClick:M(Y),isLoading:o,disabled:U.length===0||!!l.password,"data-testid":"confirmCredentialsButton",children:"Confirm"})})]})})})})}const he=t=>Q.delete("/users/me/data-vault",t),ue=({config:t}={})=>K({...t,mutationFn:he});function me({password:t}){const{watch:a,register:o,handleSubmit:i,formState:{errors:s}}=v(),c=a("confirm",!1),d=I(),m=ue(),l=()=>{m.mutate({data:{password:t}}),d("/app/settings/data-vault/success")};return e(k,{children:e(h,{height:"100%",children:e("form",{className:P.formFill,children:r(f,{mb:"24px",children:[r(h,{pb:"60px",children:[e(g,{borderRadius:"28px",background:"white",boxShadow:"DataVaultShadows.base",padding:"40px",marginBottom:"12px",children:r(n,{fontSize:"24px",children:["Are you sure"," ",e(n,{as:"span",color:"brandRed.base",display:"inline",fontWeight:"700",children:"you want to delete"})," ","your account and data?"]})}),e(h,{borderRadius:"28px",background:"white",boxShadow:"DataVaultShadows.base",w:"fill",children:e(y,{w:"fill",leftIcon:e(X,{color:"grey.light-1"}),rightIcon:e(ie,{...o("confirm",{required:!0})}),children:e(n,{fontSize:"lg",color:"black",width:"236px",children:"Yes I'm sure"})})})]}),e(u,{type:"submit",variant:"glass",size:"lg",onClick:i(l),disabled:!!s.confirm||!c,width:"114px","data-testid":"confirmDeletionButton",children:"Request"})]})})})})}function R(t){return Z({tag:"svg",attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M14.341 3.579c-0.347-0.473-0.831-1.027-1.362-1.558s-1.085-1.015-1.558-1.362c-0.806-0.591-1.197-0.659-1.421-0.659h-7.75c-0.689 0-1.25 0.561-1.25 1.25v13.5c0 0.689 0.561 1.25 1.25 1.25h11.5c0.689 0 1.25-0.561 1.25-1.25v-9.75c0-0.224-0.068-0.615-0.659-1.421zM12.271 2.729c0.48 0.48 0.856 0.912 1.134 1.271h-2.406v-2.405c0.359 0.278 0.792 0.654 1.271 1.134zM14 14.75c0 0.136-0.114 0.25-0.25 0.25h-11.5c-0.135 0-0.25-0.114-0.25-0.25v-13.5c0-0.135 0.115-0.25 0.25-0.25 0 0 7.749-0 7.75 0v3.5c0 0.276 0.224 0.5 0.5 0.5h3.5v9.75z"}},{tag:"path",attr:{d:"M11.5 13h-7c-0.276 0-0.5-0.224-0.5-0.5s0.224-0.5 0.5-0.5h7c0.276 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5z"}},{tag:"path",attr:{d:"M11.5 11h-7c-0.276 0-0.5-0.224-0.5-0.5s0.224-0.5 0.5-0.5h7c0.276 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5z"}},{tag:"path",attr:{d:"M11.5 9h-7c-0.276 0-0.5-0.224-0.5-0.5s0.224-0.5 0.5-0.5h7c0.276 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5z"}}]})(t)}const w=t=>{if(!t||t.length<0)return t;const a=t.trim().split(" "),o=a.length;if(o<4)return t;const i=`<nobr>${a[o-2]} ${a[o-1]}</nobr>`;a.splice(-2,2);const s=`${a.join(" ")} ${i}`;return e("div",{dangerouslySetInnerHTML:{__html:s}})};function pe({goToConfirmDeletion:t}){const{watch:a,register:o,handleSubmit:i,formState:{errors:s}}=v(),c=a("confirmTerms",!1),d=I(),l=J().pathname.includes("download-data"),b=()=>{l?d("/app/settings/data-vault/success"):t()};return e(C,{maxWidth:"325px",leftIcon:L,rightIcon:null,backUrl:"/app/settings",textAlign:"center",margin:"0 auto",children:e("form",{children:r(f,{alignItems:"center",pb:"6",height:"100%",mt:"50px",gap:"3",children:[r(g,{background:"white",padding:"40px",borderRadius:"32px",boxShadow:"DataVaultShadows.base",children:[r(n,{fontSize:"24px",children:["Your data will be"," ",l?r(x,{children:["accessible for download within"," ",e(n,{color:"brandRed.base",display:"inline",fontSize:"24px",children:"45 days"})]}):e(n,{color:"brandRed.base",display:"inline",fontSize:"24px",children:"deleted within 45 days"})]}),l?e(n,{fontSize:"16px",color:"#7C7F93",children:w("You\u2019ll receive an email with a link to download once it\u2019s ready. Please note that the file size may be quite large.")}):r(n,{fontSize:"16px",color:"#7C7F93",children:["This action is permanent and cannot be reversed once completed."," ",e(n,{as:"span",fontWeight:"700",children:"You will also lose access to all assets in your Cirus Wallet."})," ",w("You will be notified by email once data removal is complete and your account is closed.")]})]}),e(h,{boxShadow:"DataVaultShadows.base",borderRadius:"28px",children:e("a",{href:"https://cirusfoundation.com/privacy-policy/",target:"_blank",rel:"noreferrer",children:e(y,{leftIcon:e(R,{color:"grey.light-1"}),rightIcon:e(T,{color:"grey.light-1"}),children:e(n,{fontSize:"lg",color:"black",width:"236px",textAlign:"left",children:"Privacy Policy"})})})}),e(h,{boxShadow:"DataVaultShadows.base",borderRadius:"28px",children:e("a",{href:"https://cirusfoundation.com/terms-and-conditions/",target:"_blank",rel:"noreferrer",children:e(y,{leftIcon:e(R,{color:"grey.light-1"}),rightIcon:e(T,{color:"grey.light-1"}),children:e(n,{fontSize:"lg",color:"black",width:"236px",textAlign:"left",children:"Terms of Service"})})})}),e(ee,{...o("confirmTerms",{required:"You must agree to the Privacy Policy and Terms of Service to continue."}),children:r(n,{fontSize:"sm",color:"#7C7F93",width:"196px",marginLeft:"22px",textAlign:"left",children:["I accept the Privacy Policy and Terms of Service and"," ",l?e(x,{children:"want to download my data"}):e(x,{children:"want to delete my data"})]})}),r(u,{type:"submit",variant:"glass",size:"lg",onClick:i(b),disabled:!!s.confirmTerms||!c,"data-testid":"confirmTermsButton",children:["Request ",!l&&"to delete"]})]})})})}function B(){const[t,a]=S.exports.useState(0),[o,i]=S.exports.useState(""),s=()=>{a(2)},c=()=>{a(1)};return t===0?e(de,{goToConfirmTerms:c,setPassword:i}):t===1?e(pe,{goToConfirmDeletion:s}):t===2?e(me,{password:o}):null}function fe(){const t=I(),{data:a,isLoading:o}=te({userId:"me"});if(o)return e(ae,{});const i=(a==null?void 0:a.role)===oe.GUEST,s=()=>!!(i||a&&a.deleted_at);return e(C,{backUrl:"/app/settings",rightIcon:null,title:"Data Vault",children:r(k,{pb:"32px",gap:"3",children:[r(g,{background:"#ffffff",padding:"30px",borderRadius:"32px",boxShadow:"DataVaultShadows.base",children:[e(n,{fontSize:"lg",marginBottom:"16px",children:"Download your data"}),e(n,{fontSize:"md",color:"#7C7F93",marginBottom:"32px",children:w("Receive a copy of all the data you\u2019ve shared with Cirus from when you first signed up.")}),e(u,{leftIcon:e(se,{}),onClick:()=>t("download-data/auth"),isDisabled:i,p:"24px !important","data-testid":"downloadDataButton",children:"Download"})]}),r(g,{background:"#ffffff",padding:"30px",borderRadius:"32px",boxShadow:"DataVaultShadows.base",children:[e(n,{fontSize:"lg",marginBottom:"16px",children:"Delete account"}),e(n,{fontSize:"md",color:"#7C7F93",marginBottom:"32px",children:w("Permanently remove your Cirus Account and delete all data that has been shared with Cirus. This action cannot be reversed once completed.")}),a&&a.deleted_at?e(n,{fontSize:"md",color:"#7C7F93",marginBottom:"32px",children:"Your request has been submitted and is being processed."}):null,e(u,{leftIcon:e(le,{}),onClick:()=>t("delete-account/auth"),isDisabled:s(),p:"24px !important","data-testid":"deleteAccountButton",children:"Delete"})]})]})})}function ge(){return e(ne,{title:"Success",subtitle:"Your request has been successfully submitted",navigateTo:"/app/settings"})}function ye(){return r(re,{children:[e(p,{path:"/",element:e(fe,{})}),e(p,{path:"/download-data/auth",element:e(B,{})}),e(p,{path:"/delete-account/auth",element:e(B,{})}),e(p,{path:"/success",element:e(ge,{})})]})}export{ye as DataVaultRoutes};
